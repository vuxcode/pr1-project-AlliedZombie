<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta title="Oscar's Project">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">

<style>
   
</style>
</head>
<body>

<div id="buttonHolder" style="display: none;"> 
    <button id="buttonPhysical" onclick="PhysicalAttack()">Physical</button>
    <button id="buttonMagic" onclick="MagicalAttack()">Magic</button>
    <button id="buttonIntimidate" onclick="IntimidateAttack()">Intimidate</button>
</div>
<!---->
<div id = DevAttackButtons>
<button id="OrcAttacks" onclick="PlayerDamageByOrc()">OrcAttack</button>
<button id="MageAttacks" onclick="PlayerDamageByMage()">MageAttack</button>
<button id="TownsfolkAttacks" onclick="PlayerDamageByTownsfolk()">TownsfolkAttack</button>
</div>

<div class=gameScreen>
    <div class ="bgImage">
        <div class = "Enemies">
            <div id = "EnemyOrc" style = "display: none;"></div>
            <div id = "EnemyMage" style = "display: none;"></div>
            <div id = "EnemyTownsfolk" style = "display: none;"></div>
        </div>
        <div class = "Player" id = "Player" style = "display: none;">
            <div id = "PlayerChar"></div>
            <div id = "playerHpBar">
                <div id = "barHealth">
                    <div id = "playerHpText"></div>
                </div>
            </div>
        </div>
        
    </div>

    <div class = "Introduction" id ="Introduction" style="display:block;">
        <input type="text" name="name" id="PlayerInputName" placeholder="Your adventure name"/>
        <h2>Your task is to *Bla Bla Bla* save the princess and *Bla Bla Bla* the monsters...</h2>
        <h2>Understood? Good! May the gods be on your side in battle!</h2>
        <button type="button" id="IntroButton" onclick="getPlayerInputName();">Fight</button>
    </div>

    <div class="GameOverScreen" id="GameOverScreen" style = "display: none;">

        <h1> Game Over </h1>
        <h2> Your Highscore = </h2>
        <h2 id="Score"></h2>
    </div>
</div>

<div class ="bgImage"></div>

<!-- Comment -->
<script>

var playerHp = 100;
var playerHighScoreTest = 123456789;
var enemiesDestroyed;
var random = Math.random();


var enemy;
var enemies = ["Orc", "Mage", "Townsfolk"];

//An array of enemies that have properties to them. Will probably ad sfx properties here aswell.
var enemyProperty = [ 
{charImageId: "EnemyOrc", minDamage: 5, maxDamage:10},
{charImageId: "EnemyMage", minDamage: 3, maxDamage:6},
{charImageId: "EnemyTownsfolk", minDamage: 1, maxDamage:3}
];


//I want the program to start the introduction at the start.

function getPlayerInputName()
{
    var PlayerName = document.getElementById("PlayerInputName").value;
    if (PlayerName == "" || PlayerName == null)
    {
        PlayerName = "Adventurer"
    }
    Introduction(PlayerName);
}

function Introduction(playerInputName)
{
    // Make a pop up that introduces the player  and asks for the users name and replace the name below playerHpBar with said name.
    // Make it so the user can press outside the box and it will go away.
    // Make the rest of the game start. (Timers and start showing the enemy and Player.)

    document.getElementById("playerHpText").innerText = playerInputName;
    console.log("The players name is: " + playerInputName);
    document.getElementById("Introduction").style.display = "none";
    document.getElementById("Player").style.display="block";
    document.getElementById("buttonHolder").style.display="block";
    EnemySpawnHandler();
}


function EnemySpawnHandler ()
{
    enemy = enemies[Math.floor(random * enemies.length)]
    console.log("The Random enemy is: " + enemy)
    switch (enemy)
        {
            case "Orc":
                EnemyIntro(enemyProperty[0].charImageId)
                break;
            case "Mage":
                EnemyIntro(enemyProperty[1].charImageId)
                break;
            case "Townsfolk":
                EnemyIntro(enemyProperty[2].charImageId)
                break;
    }
}

function EnemyIntro(Enemy)
{
    document.getElementById(Enemy).style.display="block";
    //EnemyStatus(Enemy)
}

/*
function EnemyStatus(Enemy)
{
    setTimeout(EnemyExit,3000,Enemy)
}
*/

function EnemyExit(Enemy)
{
    console.log("EnemyExit")
    document.getElementById(Enemy).style.animationName = "EnemyExitAnim";
    enemiesDestroyed ++;
    EnemySpawnHandler();
}
//#region PlayerAttacks

function PhysicalAttack()
{ 
    switch(enemy)
        {
            case "Orc":
                EnemyExit("EnemyOrc");
                break;
            case "Mage":
                PlayerDamageByMage();
                break;
            case "Townsfolk":
                PlayerDamageByTownsfolk();
                break;
        }
        console.log(enemy);    
    console.log("Player used Physical Attack")
}

function MagicalAttack()
{
    switch(enemy)
        {
            case "Orc":
                PlayerDamageByOrc();
                break;
            case "Mage":
                EnemyExit("EnemyMage");
                break;
            case "Townsfolk":
                PlayerDamageByTownsfolk();
                break;
        }
    console.log(enemy);
    console.log("Player used Magical Attack")
}

function IntimidateAttack()
{
    switch(enemy)
        {
            case "Orc":
                PlayerDamageByOrc();
                break;
            case "Mage":
                PlayerDamageByMage();
                break;
            case "Townsfolk":
                EnemyExit("EnemyTownsfolk");
                break;
        }
    console.log("Player used Intimidate Attack")
    console.log(enemy);   
}

//#endregion






function PlayerDamageByOrc()
{
    var damage = getRandomInt(enemyProperty[0].minDamage,enemyProperty[0].maxDamage)
    playerHp -= damage
    document.getElementById("barHealth").style.width = playerHp + "%";
    console.log("Orc hit the player with: " + damage + ". The player is now at :" + playerHp + "%");
    if (playerHp < 0){
        KillPlayer();} 
}

function PlayerDamageByMage()
{
    var damage = getRandomInt(enemyProperty[1].minDamage,enemyProperty[1].maxDamage)
    playerHp -= damage
    document.getElementById("barHealth").style.width = playerHp + "%";
    console.log("Mage hit the player with: " + damage + ". The player is now at :" + playerHp + "%");
    if (playerHp < 0){
        KillPlayer();} 
}

function PlayerDamageByTownsfolk()
{
    var damage = getRandomInt(enemyProperty[2].minDamage,enemyProperty[2].maxDamage)
    playerHp -= damage
    document.getElementById("barHealth").style.width = playerHp + "%";
    console.log("Townsfolk hit the player with: " + damage + ". The player is now at :" + playerHp + "%");
    if (playerHp < 0){
        KillPlayer();}
}


//Instead of calculating the random value in each function I decided to make it separate. So This function takes a value from the Damage scripts and returns the randomized value. 
//Not a necessary function but I wanted to explore different methods to return a value from other functions.
function getRandomInt(min, max) 
{
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

//When this gets called it will change som css and do some functions
function KillPlayer()
{
    document.getElementById("barHealth").style.width = 0 + "%";
    //Add a game over popup with the Highscore.
    //add a Restart game function and start it here?
    GameOverScreen();

}

function SfxHandler(sfxtype)
{
    //Make a sound play depending on what the sfx type is inpouted in the function SfxHandler.
    //Will probably be enemyTakingDamage, PlayerTakingDamage etc 
} 

function GameOverScreen(PlayerScore)
{
    document.getElementById("GameOverScreen").style.display = "block";
    document.getElementById("buttonHolder").style.display="none";
    document.getElementById("Score").innerText = playerHighScoreTest;
}


</script>
</body>
</html>